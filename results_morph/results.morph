<?xml version="1.0" encoding="utf-8"?>
<Project Version="26" AppVersion="5.5.0.6" ReadKey="readkey.qxt3JIeOrIY=.OXiUF+LFBZMSorIdBPzeRw==.DHLqzdp1fTjkxMP9NPtFjjVrcfRUDzS5rSNXda6t9OQvP3n2sDLPK8lxjQnvynlZjy4/4ihw36xBkVUD4isGV5iTKaI1uR9B33PeWmOUZIw=.WEnpuB36UoaG2xcXnsqcWOAMQQAa+aBDzcVqAVwQtlc=." WriteKeyPublic="BgIAAACkAABSU0ExAAgAAAEAAQCtNL6ihZ7TG2Dvgk6CSi7VfrbR5knPf6rrD0IkcVXNUOl1oC9U8wZUE5BObDUWSVISaHXdxEgFjQOiwelOUMMOwutF5cU0TopWUP/C2BbKewj+jW/efo9D8M+y/IIgqKkLv7J8ReFAfd/eDG3YiaOzYnYWZhJfSrMQCTDwiQb/BBDGuc2oG92uj8RGYoX6hIMvFj/XncuSxsdGjUkco4WjnA8DrBA+R1vs1SS6X2SUGfdRLFOj1pi6wMkWGObSFa7LPfvEH1UIrDJ/fmBQQoZeG3rDBu2irpgoK5mQZi2Bn3W41Zd8H2OdS28k3vkNHIrn5j8pnRIo4RWQQwcHRDjY" StartModuleName="Main" EditedBy="CORP\Stratify" LastEdited="2023-11-29T01:50:19.2188277Z" Signature="rhQ5JgmME3YuOUovQqWOn+Z4LbICDBykJfY5e0Aoz2w=">
  <Modules>
    <Module Name="Main" AutoRun="true" SelectedGroupName="Group 1">
      <Groups>
        <Group Name="Group 1">
          <ModelObjects>
            <Table Name="Table 1" Left="714" Top="247" Width="500" Height="300" IsMinimized="false" ActiveActionIndex="10">
              <Actions>
                <DeriveTableAction SourceTableName="Table 2" IsConditional="false" />
                <IterateAction IterationMode="IterateAndAppendResults" UseDefaultResultTable="true" FailureOption="Halt">
                  <MetaColumns>
                    <MetaColumn OriginalName="Main_x0020_metrics" Width="109" />
                  </MetaColumns>
                  <CallableUnitDefinition Type="Module">
                    <ModuleName Value="Module 1" Type="List" />
                  </CallableUnitDefinition>
                  <CallParameters>
                    <CallParameter ParameterName="File name">
                      <Value Value="File name with full path" Type="List" />
                    </CallParameter>
                  </CallParameters>
                </IterateAction>
                <MergeAction SecondTableName="Table 2" SecondTableExists="true" MergeMode="Lookup">
                  <Columns>
                    <Item>bacteria</Item>
                    <Item>model</Item>
                    <Item>bin</Item>
                  </Columns>
                  <MatchingColumns>
                    <NamePair Name1="File name with full path" Name2="File name with full path" />
                  </MatchingColumns>
                </MergeAction>
                <KeepRemoveColumnsAction Mode="Remove">
                  <ColumnNames>
                    <Item>File name with full path</Item>
                  </ColumnNames>
                </KeepRemoveColumnsAction>
                <RenameColumnsAction>
                  <Names>
                    <NamePair Name1="Column 1" Name2="Result" />
                    <NamePair Name1="Main metrics" Name2="Metric" />
                  </Names>
                </RenameColumnsAction>
                <AddColumnsAction>
                  <Columns>
                    <NameExpressionPair Name="Metric_Bin">
                      <Expression Value="[Metric]&amp;[bin]" Type="Expression" />
                    </NameExpressionPair>
                  </Columns>
                  <InsertPosition ColumnName="" Position="Rightmost" />
                </AddColumnsAction>
                <KeepRemoveColumnsAction Mode="Remove">
                  <ColumnNames>
                    <Item>bin</Item>
                    <Item>Metric</Item>
                  </ColumnNames>
                </KeepRemoveColumnsAction>
                <PivotAction LabelsColumnName="Metric_Bin" DataColumnName="Result" Aggregation="Sum" PreserveFormatting="false" />
                <ReorderColumnsAction>
                  <PositionRules>
                    <ColumnPositionRule ColumnName="model" Position="Leftmost" />
                  </PositionRules>
                </ReorderColumnsAction>
                <SortAction>
                  <SortColumns>
                    <SortColumn ColumnName="model" SortOrder="Ascending" />
                  </SortColumns>
                </SortAction>
                <ExportExcelAction ExportMode="Create" CreateNamedRange="false" CreateTable="false" FileExistsOption="Overwrite">
                  <FileName Value="results_agg" Type="Path" />
                  <WorksheetName Value="Sheet1" Type="Text" />
                </ExportExcelAction>
              </Actions>
              <AnalysisView LayoutMode="Filters">
                <Filters>
                  <Filter ColumnName="model" Width="230" ValueColumnWidth="120" CountColumnWidth="80" />
                </Filters>
              </AnalysisView>
            </Table>
            <Table Name="Table 2" Left="103" Top="184" Width="500" Height="307" IsMinimized="false" ActiveActionIndex="1">
              <Actions>
                <FileListAction ScanSubfolders="false">
                  <MetaColumns>
                    <MetaColumn OriginalName="File_x0020_name_x0020_with_x0020_full_x0020_path" Width="122" />
                  </MetaColumns>
                  <FolderPath Value="D:\Users\Stratify\Stratify\Stratify Interno - Documents\Old\test" Type="Path" />
                  <Columns>
                    <Item>FileNameWithPath</Item>
                    <Item>FileName</Item>
                    <Item>FileExtension</Item>
                  </Columns>
                </FileListAction>
                <SelectionFilterAction ColumnName="File extension" RemoveSelectedValues="false">
                  <Cells>
                    <C T="s" V=".txt" />
                  </Cells>
                </SelectionFilterAction>
                <AddColumnsAction>
                  <Columns>
                    <NameExpressionPair Name="bacteria">
                      <Expression Value="if(&#xD;&#xA;    contains([File name only], &quot;e_coli&quot;), &#xD;&#xA;    &quot;E. Coli&quot;, &#xD;&#xA;    if(&#xD;&#xA;        contains([File name only], &quot;k_pneumoniae&quot;),&#xD;&#xA;        &quot;K. Pneumoniae&quot;,&#xD;&#xA;        if(&#xD;&#xA;            contains([File name only], &quot;s_aureus&quot;),&#xD;&#xA;            &quot;S. Aureus&quot;,&#xD;&#xA;            if(&#xD;&#xA;                contains([File name only], &quot;p_aeruginosa&quot;),&#xD;&#xA;                &quot;P. Aeruginosa&quot;,&#xD;&#xA;                &quot;&quot;&#xD;&#xA;            &#xD;&#xA;            )&#xD;&#xA;        &#xD;&#xA;        )&#xD;&#xA;    &#xD;&#xA;    )&#xD;&#xA;)" Type="Expression" />
                    </NameExpressionPair>
                    <NameExpressionPair Name="model">
                      <Expression Value="if(&#xD;&#xA;    contains([File name only], &quot;xgb&quot;), &#xD;&#xA;    &quot;XGB&quot;, &#xD;&#xA;    if(&#xD;&#xA;        contains([File name only], &quot;svc&quot;),&#xD;&#xA;        &quot;SVC&quot;,&#xD;&#xA;        if(&#xD;&#xA;            contains([File name only], &quot;tabpfn&quot;),&#xD;&#xA;            &quot;TabPFN&quot;,&#xD;&#xA;            if(&#xD;&#xA;                contains([File name only], &quot;nn&quot;),&#xD;&#xA;                &quot;NN&quot;,&#xD;&#xA;                &quot;&quot;&#xD;&#xA;            &#xD;&#xA;            )&#xD;&#xA;        &#xD;&#xA;        )&#xD;&#xA;    &#xD;&#xA;    )&#xD;&#xA;)" Type="Expression" />
                    </NameExpressionPair>
                    <NameExpressionPair Name="bin">
                      <Expression Value="if(&#xD;&#xA;    contains([File name only], &quot;bin5&quot;), &#xD;&#xA;    &quot;Bin 5&quot;, &#xD;&#xA;    if(&#xD;&#xA;        contains([File name only], &quot;bin20&quot;),&#xD;&#xA;        &quot;Bin 20&quot;,&#xD;&#xA;        if(&#xD;&#xA;            contains([File name only], &quot;bin40&quot;),&#xD;&#xA;            &quot;Bin 40&quot;,&#xD;&#xA;            if(&#xD;&#xA;                contains([File name only], &quot;selected&quot;),&#xD;&#xA;                &quot;RFE&quot;,&#xD;&#xA;                &quot;Bin 1&quot;&#xD;&#xA;            &#xD;&#xA;            )&#xD;&#xA;        &#xD;&#xA;        )&#xD;&#xA;    &#xD;&#xA;    )&#xD;&#xA;)" Type="Expression" />
                    </NameExpressionPair>
                  </Columns>
                  <InsertPosition ColumnName="" Position="Rightmost" />
                </AddColumnsAction>
              </Actions>
              <AnalysisView LayoutMode="Filters" />
            </Table>
          </ModelObjects>
        </Group>
      </Groups>
      <Parameters />
      <Report UseCustomFileNameForPdfExport="false" ShowPageBorders="true">
        <Pages>
          <Page Name="Page 1" IncludeInReport="true">
            <ReportObjects />
          </Page>
        </Pages>
        <PageSetup Orientation="Landscape" Margin="Narrow" Size="Letter" />
      </Report>
    </Module>
    <Module Name="Module 1" AutoRun="true" SelectedGroupName="Group 1">
      <Groups>
        <Group Name="Group 1">
          <ModelObjects>
            <Table Name="e_coli_driams_bin5_svc_results.txt" Left="344" Top="173" Width="500" Height="300" IsMinimized="false" ActiveActionIndex="0">
              <Actions>
                <ImportDelimitedTextAction DecimalSeparator="Point" ThousandSeparator="Default" ShowParsingErrors="false" IgnoreQuoting="false" NumericValuesTreatmentOption="AlwaysAsNumbers" ColumnsDontHaveHeaders="false" LoadAllColumns="true" AddColumnsWhenRowsHaveMoreValuesThanHeaders="false">
                  <MetaColumns>
                    <MetaColumn OriginalName="Main_x0020_metrics" Width="109" />
                  </MetaColumns>
                  <InputFileDefinition Mode="Single">
                    <FileName Value="File name" Type="Parameter" />
                  </InputFileDefinition>
                  <SkipLines Value="0" Type="Number" />
                  <MaxLines Value="0" Type="Number" />
                  <Separator SeparatorType="Custom" CustomSeparator="3A" />
                  <Encoding EncodingType="UTF8" />
                </ImportDelimitedTextAction>
                <SelectionFilterAction ColumnName="Main metrics" RemoveSelectedValues="false">
                  <Cells>
                    <C T="s" V="Hamming Loss" />
                    <C T="s" V="Accuracy" />
                    <C T="s" V="F1 Score (Weighted)" />
                  </Cells>
                </SelectionFilterAction>
              </Actions>
              <AnalysisView LayoutMode="Filters" />
            </Table>
          </ModelObjects>
        </Group>
      </Groups>
      <Parameters>
        <FilePathParameter Name="File name" Value="D:\Users\Stratify\Stratify\Stratify Interno - Documents\Old\test\e_coli_driams_bin5_svc_results.txt" />
      </Parameters>
      <Report UseCustomFileNameForPdfExport="false" ShowPageBorders="true">
        <Pages>
          <Page Name="Page 1" IncludeInReport="true">
            <ReportObjects />
          </Page>
        </Pages>
        <PageSetup Orientation="Landscape" Margin="Narrow" Size="Letter" />
      </Report>
    </Module>
  </Modules>
  <ProtectedDataConnectors />
  <Resources />
</Project>